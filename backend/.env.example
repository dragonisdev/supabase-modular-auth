# Supabase Configuration
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Server Configuration
PORT=3000
NODE_ENV=development

# Backend URL (Required for OAuth callbacks)
BACKEND_URL=http://localhost:3000

# Frontend URL (Required for CORS and redirects)
FRONTEND_URL=http://localhost:3001

# Cookie Configuration
# Cookie name (will be prefixed with __Host- in production for security)
COOKIE_NAME=auth_token

# Domain for cookies (optional - only needed for cross-subdomain cookies)
# Leave empty in production to use __Host- prefix (recommended)
# COOKIE_DOMAIN=.example.com

# Set to true in production (requires HTTPS)
COOKIE_SECURE=false

# CSRF protection: 'strict' (recommended), 'lax', or 'none'
COOKIE_SAME_SITE=lax

# Cookie lifetime in days
COOKIE_MAX_AGE_DAYS=7

# Rate Limiting
# Protects against brute force attacks
# Time window for rate limiting (milliseconds, default: 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# Max requests per window for general endpoints (development)
RATE_LIMIT_MAX_REQUESTS=100

# Max requests per window for auth endpoints (stricter)
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# Max requests per window in production (general endpoints)
STRICT_RATE_LIMIT_MAX_REQUESTS=20

# Security Settings
# Trust proxy setting for IP detection behind reverse proxy
# Options: 'true', 'false', or number of hops (e.g., '1')
TRUST_PROXY=1

# Request timeout in milliseconds (default: 30 seconds)
REQUEST_TIMEOUT_MS=30000

# Maximum request body size (default: 10kb)
MAX_REQUEST_SIZE=10kb

# Account Lockout Settings
# Protects against brute force password guessing
# Number of failed login attempts before lockout
LOCKOUT_MAX_ATTEMPTS=5

# Lockout duration in milliseconds (default: 15 minutes)
# Progressive lockout doubles this on repeat offenses
LOCKOUT_DURATION_MS=900000
